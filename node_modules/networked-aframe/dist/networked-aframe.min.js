!function(t){function u(n){if(e[n])return e[n].exports;var i=e[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,u),i.loaded=!0,i.exports}var e={};return u.m=t,u.c=e,u.p="",u(0)}([function(t,u,e){"use strict";e(10),e(9),e(3),e(62),e(63),e(61)},function(t,u){"use strict";var e=Array.prototype.forEach,n=Object.create;t.exports=function(t){var u=n(null);return e.call(arguments,function(t){u[t]=!0}),u}},function(t,u){"use strict";t.exports=function(t){if(null==t)throw new TypeError("Cannot use null or undefined");return t}},function(t,u,e){"use strict";var n=e(64),i=e(65),r=e(54),o=e(53),a=e(57),s=e(56),D=e(55),c=e(58),l={};l.app="",l.room="",l.clientId="",l.options=n,l.utils=i,l.physics=r,l.log=new o,l.schemas=new a,l.version="0.4.0",l.adapters=new c;var C=new s,d=new D(C);l.connection=d,l.entities=C,t.exports=window.NAF=l},function(t,u,e){"use strict";t.exports=e(15)()?Array.from:e(16)},function(t,u,e){"use strict";var n,i=e(25),r=e(6),o=e(28),a=e(32);n=t.exports=function(t,u){var e,n,o,s,D;return arguments.length<2||"string"!=typeof t?(s=u,u=t,t=null):s=arguments[2],null==t?(e=o=!0,n=!1):(e=a.call(t,"c"),n=a.call(t,"e"),o=a.call(t,"w")),D={value:u,configurable:e,enumerable:n,writable:o},s?i(r(s),D):D},n.gs=function(t,u,e){var n,s,D,c;return"string"!=typeof t?(D=e,e=u,u=t,t=null):D=arguments[3],null==u?u=void 0:o(u)?null==e?e=void 0:o(e)||(D=e,e=void 0):(D=u,u=e=void 0),null==t?(n=!0,s=!1):(n=a.call(t,"c"),s=a.call(t,"e")),c={get:u,set:e,configurable:n,enumerable:s},D?i(r(D),c):c}},function(t,u){"use strict";var e=Array.prototype.forEach,n=Object.create,i=function(t,u){var e;for(e in t)u[e]=t[e]};t.exports=function(t){var u=n(null);return e.call(arguments,function(t){null!=t&&i(Object(t),u)}),u}},function(t,u){"use strict";t.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},function(t,u,e){"use strict";var n=e(4),i=e(1);t.exports=i.apply(null,n("\n\r\u2028\u2029"))},function(t,u,e){"use strict";if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var n=THREE.Math.degToRad,i=e(11);AFRAME.registerComponent("lerp",{schema:{properties:{default:["position","rotation","scale"]}},init:function(){var t=this.el;this.lastPosition=t.getAttribute("position"),this.lastRotation=t.getAttribute("rotation"),this.lastScale=t.getAttribute("scale"),this.lerpingPosition=!1,this.lerpingRotation=!1,this.lerpingScale=!1,this.timeOfLastUpdate=0},tick:function(t,u){var e,n=this.now(),i=this.el.object3D;this.checkForComponentChanged(),this.lerpingPosition&&(e=(n-this.startLerpTimePosition)/this.duration,i.position.lerpVectors(this.startPosition,this.targetPosition,e),e>=1&&(this.lerpingPosition=!1)),this.lerpingRotation&&(e=(n-this.startLerpTimeRotation)/this.duration,THREE.Quaternion.slerp(this.startRotation,this.targetRotation,i.quaternion,e),e>=1&&(this.lerpingRotation=!1)),this.lerpingScale&&(e=(n-this.startLerpTimeScale)/this.duration,i.scale.lerpVectors(this.startScale,this.targetScale,e),e>=1&&(this.lerpingScale=!1))},checkForComponentChanged:function(){var t=this.el,u=!1,e=t.getAttribute("position");this.isLerpable("position")&&!this.almostEqualVec3(this.lastPosition,e)&&(this.toPosition(this.lastPosition,e),this.lastPosition=e,u=!0);var n=t.getAttribute("rotation");this.isLerpable("rotation")&&!this.almostEqualVec3(this.lastRotation,n)&&(this.toRotation(this.lastRotation,n),this.lastRotation=n,u=!0);var i=t.getAttribute("scale");this.isLerpable("scale")&&!this.almostEqualVec3(this.lastScale,i)&&(this.toScale(this.lastScale,i),this.lastScale=i,u=!0),u&&this.updateDuration()},isLerpable:function(t){return this.data.properties.indexOf(t)!=-1},updateDuration:function(){var t=this.now();this.duration=t-this.timeOfLastUpdate,this.timeOfLastUpdate=t},toPosition:function(t,u){this.lerpingPosition=!0,this.startLerpTimePosition=this.now(),this.startPosition=new THREE.Vector3(t.x,t.y,t.z),this.targetPosition=new THREE.Vector3(u.x,u.y,u.z)},toRotation:function(t,u){this.lerpingRotation=!0,this.startLerpTimeRotation=this.now(),this.startRotation=new THREE.Quaternion,this.startRotation.setFromEuler(new THREE.Euler(n(t.x),n(t.y),n(t.z),"YXZ")),this.targetRotation=new THREE.Quaternion,this.targetRotation.setFromEuler(new THREE.Euler(n(u.x),n(u.y),n(u.z),"YXZ"))},toScale:function(t,u){this.lerpingScale=!0,this.startLerpTimeScale=this.now(),this.startScale=new THREE.Vector3(t.x,t.y,t.z),this.targetScale=new THREE.Vector3(u.x,u.y,u.z)},almostEqualVec3:function(t,u){return i(t.x,u.x)&&i(t.y,u.y)&&i(t.z,u.z)},now:function(){return Date.now()}})},function(t,u,e){"use strict";function n(t,u,e){return new Promise(function(n){l(u).then(function(){p[t]={template:a(u)(e.trim()),type:u},n(p[t])})})}function i(t,u,e){switch(u){case A:return t(e);case E:return t(e);case y:return Mustache.render(t,e);case m:return t.render(e);default:return C(t,e)}}function r(t,u){var e=document.querySelector(t),i=e.getAttribute("type"),r=e.innerHTML;if(!u){if(!i)throw new Error("Must provide `type` attribute for <script> templates (e.g., handlebars, jade, nunjucks, html)");if(i.indexOf("handlebars")!==-1)u=A;else if(i.indexOf("jade")!==-1)u=E;else if(i.indexOf("mustache")!==-1)u=y;else if(i.indexOf("nunjucks")!==-1)u=m;else{if(i.indexOf("html")===-1)return void f("Template type could not be inferred from the script tag. Please add a type.");u=v}}return new Promise(function(e){n(t,u,r).then(function(t){e(t,u)})})}function o(t,u){return new Promise(function(e){var i;i=new XMLHttpRequest,i.addEventListener("load",function(){n(t,u,i.response).then(function(t){e(t,u)})}),i.open("GET",t),i.send()})}function a(t){switch(t){case A:return s;case E:return D;case y:return s;case m:return c;default:return function(t){return t}}}function s(t){return Handlebars.compile(t)}function D(t){return jade.compile(t)}function c(t){return nunjucks.compile(t)}function l(t){return new Promise(function(u){if(!t||"html"===t)return u();var e=B[t];if(B[t]===!0)return u();e||(e=document.createElement("script"),B[t]=e,e.setAttribute("src",b[t]),F('Lazy-loading %s engine. Please add <script src="%s"> to your page.',t,b[t]),document.body.appendChild(e));var n=e.onload||function(){};e.onload=function(){n(),B[t]=!0,u()}})}var C=e(42),d=AFRAME.utils.debug,h=AFRAME.utils.extend,p={},f=d("template-component:error"),F=d("template-component:info"),A="handlebars",E="jade",y="mustache",m="nunjucks",v="html",B={};B[A]=!!window.Handlebars,B[E]=!!window.jade,B[y]=!!window.Mustache,B[m]=!!window.nunjucks;var b={};b[A]="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js",b[E]="https://cdnjs.cloudflare.com/ajax/libs/jade/1.11.0/jade.min.js",b[y]="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.2.1/mustache.min.js",b[m]="https://cdnjs.cloudflare.com/ajax/libs/nunjucks/2.3.0/nunjucks.min.js",AFRAME.registerComponent("template",{schema:{insert:{default:"beforeend"},type:{default:""},src:{default:""},data:{default:""}},update:function(t){var u=this.data,e=this.el,n="#"===u.src[0]?r:o,i=p[u.src];if(t&&t.src!==u.src)for(;e.firstChild;)e.removeChild(e.firstChild);return i?void this.renderTemplate(i):void n(u.src,u.type).then(this.renderTemplate.bind(this))},renderTemplate:function(t){var u=this.el,e=this.data,n={};Object.keys(u.dataset).forEach(function(t){n[t]=u.dataset[t]}),e.data&&(n=h(n,u.getAttribute(e.data)));var r=i(t.template,t.type,n);u.insertAdjacentHTML(e.insert,r),u.emit("templaterendered")}}),AFRAME.registerComponent("template-set",{schema:{on:{type:"string"},src:{type:"string"},data:{type:"string"}},init:function(){var t=this.data,u=this.el;u.addEventListener(t.on,function(){u.setAttribute("template",{src:t.src,data:t.data})})}})},function(t,u){"use strict";function e(t,u,r,o){var a=n(t-u);return null==r&&(r=e.DBL_EPSILON),null==o&&(o=r),a<=r||(a<=o*i(n(t),n(u))||t===u)}var n=Math.abs,i=Math.min;e.FLT_EPSILON=1.1920929e-7,e.DBL_EPSILON=2.220446049250313e-16,t.exports=e},function(t,u,e){"use strict";function n(t){return null===t||void 0===t}function i(t){return!(!t||"object"!==("undefined"==typeof t?"undefined":o(t))||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}function r(t,u,e){var r,l;if(n(t)||n(u))return!1;if(t.prototype!==u.prototype)return!1;if(D(t))return!!D(u)&&(t=a.call(t),u=a.call(u),c(t,u,e));if(i(t)){if(!i(u))return!1;if(t.length!==u.length)return!1;for(r=0;r<t.length;r++)if(t[r]!==u[r])return!1;return!0}try{var C=s(t),d=s(u)}catch(t){return!1}if(C.length!=d.length)return!1;for(C.sort(),d.sort(),r=C.length-1;r>=0;r--)if(C[r]!=d[r])return!1;for(r=C.length-1;r>=0;r--)if(l=C[r],!c(t[l],u[l],e))return!1;return("undefined"==typeof t?"undefined":o(t))===("undefined"==typeof u?"undefined":o(u))}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=Array.prototype.slice,s=e(14),D=e(13),c=t.exports=function(t,u,e){return e||(e={}),t===u||(t instanceof Date&&u instanceof Date?t.getTime()===u.getTime():!t||!u||"object"!=("undefined"==typeof t?"undefined":o(t))&&"object"!=("undefined"==typeof u?"undefined":o(u))?e.strict?t===u:t==u:r(t,u,e))}},function(t,u){"use strict";function e(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function n(t){return t&&"object"==("undefined"==typeof t?"undefined":i(t))&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();u=t.exports=r?e:n,u.supported=e,u.unsupported=n},function(t,u){"use strict";function e(t){var u=[];for(var e in t)u.push(e);return u}u=t.exports="function"==typeof Object.keys?Object.keys:e,u.shim=e},function(t,u){"use strict";t.exports=function(){var t,u,e=Array.from;return"function"==typeof e&&(t=["raz","dwa"],u=e(t),Boolean(u&&u!==t&&"dwa"===u[1]))}},function(t,u,e){"use strict";var n=e(36).iterator,i=e(17),r=e(18),o=e(24),a=e(7),s=e(2),D=e(35),c=Array.isArray,l=Function.prototype.call,C={configurable:!0,enumerable:!0,writable:!0,value:null},d=Object.defineProperty;t.exports=function(t){var u,e,h,p,f,F,A,E,y,m,v=arguments[1],B=arguments[2];if(t=Object(s(t)),null!=v&&a(v),this&&this!==Array&&r(this))u=this;else{if(!v){if(i(t))return f=t.length,1!==f?Array.apply(null,t):(p=new Array(1),p[0]=t[0],p);if(c(t)){for(p=new Array(f=t.length),e=0;e<f;++e)p[e]=t[e];return p}}p=[]}if(!c(t))if(void 0!==(y=t[n])){for(A=a(y).call(t),u&&(p=new u),E=A.next(),e=0;!E.done;)m=v?l.call(v,B,E.value,e):E.value,u?(C.value=m,d(p,e,C)):p[e]=m,E=A.next(),++e;f=e}else if(D(t)){for(f=t.length,u&&(p=new u),e=0,h=0;e<f;++e)m=t[e],e+1<f&&(F=m.charCodeAt(0),F>=55296&&F<=56319&&(m+=t[++e])),m=v?l.call(v,B,m,h):m,u?(C.value=m,d(p,h,C)):p[h]=m,++h;f=h}if(void 0===f)for(f=o(t.length),u&&(p=new u(f)),e=0;e<f;++e)m=v?l.call(v,B,t[e],e):t[e],u?(C.value=m,d(p,e,C)):p[e]=m;return u&&(C.value=null,p.length=f),p}},function(t,u){"use strict";var e=Object.prototype.toString,n=e.call(function(){return arguments}());t.exports=function(t){return e.call(t)===n}},function(t,u,e){"use strict";var n=Object.prototype.toString,i=n.call(e(19));t.exports=function(t){return"function"==typeof t&&n.call(t)===i}},function(t,u){"use strict";t.exports=function(){}},function(t,u,e){"use strict";t.exports=e(21)()?Math.sign:e(22)},function(t,u){"use strict";t.exports=function(){var t=Math.sign;return"function"==typeof t&&(1===t(10)&&t(-20)===-1)}},function(t,u){"use strict";t.exports=function(t){return t=Number(t),isNaN(t)||0===t?t:t>0?1:-1}},function(t,u,e){"use strict";var n=e(20),i=Math.abs,r=Math.floor;t.exports=function(t){return isNaN(t)?0:(t=Number(t),0!==t&&isFinite(t)?n(t)*r(i(t)):t)}},function(t,u,e){"use strict";var n=e(23),i=Math.max;t.exports=function(t){return i(0,n(t))}},function(t,u,e){"use strict";t.exports=e(26)()?Object.assign:e(27)},function(t,u){"use strict";t.exports=function(){var t,u=Object.assign;return"function"==typeof u&&(t={foo:"raz"},u(t,{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},function(t,u,e){"use strict";var n=e(29),i=e(2),r=Math.max;t.exports=function(t,u){var e,o,a,s=r(arguments.length,2);for(t=Object(i(t)),a=function(n){try{t[n]=u[n]}catch(t){e||(e=t)}},o=1;o<s;++o)u=arguments[o],n(u).forEach(a);if(void 0!==e)throw e;return t}},function(t,u){"use strict";t.exports=function(t){return"function"==typeof t}},function(t,u,e){"use strict";t.exports=e(30)()?Object.keys:e(31)},function(t,u){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},function(t,u){"use strict";var e=Object.keys;t.exports=function(t){return e(null==t?t:Object(t))}},function(t,u,e){"use strict";t.exports=e(33)()?String.prototype.contains:e(34)},function(t,u){"use strict";var e="razdwatrzy";t.exports=function(){return"function"==typeof e.contains&&(e.contains("dwa")===!0&&e.contains("foo")===!1)}},function(t,u){"use strict";var e=String.prototype.indexOf;t.exports=function(t){return e.call(this,t,arguments[1])>-1}},function(t,u){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=Object.prototype.toString,i=n.call("");t.exports=function(t){return"string"==typeof t||t&&"object"===("undefined"==typeof t?"undefined":e(t))&&(t instanceof String||n.call(t)===i)||!1}},function(t,u,e){"use strict";t.exports=e(37)()?Symbol:e(39)},function(t,u){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n={object:!0,symbol:!0};t.exports=function(){var t;if("function"!=typeof Symbol)return!1;t=Symbol("test symbol");try{String(t)}catch(t){return!1}return!!n[e(Symbol.iterator)]&&(!!n[e(Symbol.toPrimitive)]&&!!n[e(Symbol.toStringTag)])}},function(t,u){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){return!!t&&("symbol"===("undefined"==typeof t?"undefined":e(t))||!!t.constructor&&("Symbol"===t.constructor.name&&"Symbol"===t[t.constructor.toStringTag]))}},function(t,u,e){"use strict";var n,i,r,o,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=e(5),D=e(40),c=Object.create,l=Object.defineProperties,C=Object.defineProperty,d=Object.prototype,h=c(null);if("function"==typeof Symbol){n=Symbol;try{String(n()),o=!0}catch(t){}}var p=function(){var t=c(null);return function(u){for(var e,n,i=0;t[u+(i||"")];)++i;return u+=i||"",t[u]=!0,e="@@"+u,C(d,e,s.gs(null,function(t){n||(n=!0,C(this,e,s(t)),n=!1)})),e}}();r=function(t){if(this instanceof r)throw new TypeError("Symbol is not a constructor");return i(t)},t.exports=i=function t(u){var e;if(this instanceof t)throw new TypeError("Symbol is not a constructor");return o?n(u):(e=c(r.prototype),u=void 0===u?"":String(u),l(e,{__description__:s("",u),__name__:s("",p(u))}))},l(i,{for:s(function(t){return h[t]?h[t]:h[t]=i(String(t))}),keyFor:s(function(t){var u;D(t);for(u in h)if(h[u]===t)return u}),hasInstance:s("",n&&n.hasInstance||i("hasInstance")),isConcatSpreadable:s("",n&&n.isConcatSpreadable||i("isConcatSpreadable")),iterator:s("",n&&n.iterator||i("iterator")),match:s("",n&&n.match||i("match")),replace:s("",n&&n.replace||i("replace")),search:s("",n&&n.search||i("search")),species:s("",n&&n.species||i("species")),split:s("",n&&n.split||i("split")),toPrimitive:s("",n&&n.toPrimitive||i("toPrimitive")),toStringTag:s("",n&&n.toStringTag||i("toStringTag")),unscopables:s("",n&&n.unscopables||i("unscopables"))}),l(r.prototype,{constructor:s(i),toString:s("",function(){return this.__name__})}),l(i.prototype,{toString:s(function(){return"Symbol ("+D(this).__description__+")"}),valueOf:s(function(){return D(this)})}),C(i.prototype,i.toPrimitive,s("",function(){var t=D(this);return"symbol"===("undefined"==typeof t?"undefined":a(t))?t:t.toString()})),C(i.prototype,i.toStringTag,s("c","Symbol")),C(r.prototype,i.toStringTag,s("c",i.prototype[i.toStringTag])),C(r.prototype,i.toPrimitive,s("c",i.prototype[i.toPrimitive]))},function(t,u,e){"use strict";var n=e(38);t.exports=function(t){if(!n(t))throw new TypeError(t+" is not a symbol");return t}},function(t,u,e){"use strict";var n,i,r,o,a,s,D,c,l,C,d=e(46);a=function(t){return"\\"===t?s:"$"===t?D:(i+=t,a)},s=function(t){return"\\"!==t&&"$"!==t&&(i+="\\"),i+=t,a},D=function(t){return"{"===t?(r.push(i),i="",c):"$"===t?(i+="$",D):(i+="$"+t,a)},c=function(t){var u,e=C.slice(n);return d(e,"}",function(t){return d.nest>=0?d.next():void(u=t)}),null!=u?(o.push(C.slice(n,n+u)),n+=u,i="",a):(u=e.length,n+=u,i+=e,c)},l=function(t){return"\\"!==t&&"}"!==t&&(i+="\\"),i+=t,c},t.exports=function(t){var u,e,d;for(i="",r=[],o=[],C=String(t),u=C.length,e=a,n=0;n<u;++n)e=e(C[n]);return e===a?r.push(i):e===s?r.push(i+"\\"):e===D?r.push(i+"$"):e===c?r[r.length-1]+="${"+i:e===l&&(r[r.length-1]+="${"+i+"\\"),d={literals:r,substitutions:o},r=o=null,d}},function(t,u,e){"use strict";var n=e(41),i=e(44);t.exports=function(t,u){return i(n(t),u,arguments[2])}},function(t,u){"use strict";var e=Array.prototype.reduce;t.exports=function(t){var u=arguments;return e.call(t,function(t,e,n){return t+(void 0===u[n]?"":String(u[n]))+e})}},function(t,u,e){"use strict";var n=e(45),i=e(43);t.exports=function(t,u){return i.apply(null,n(t,u,arguments[2]))}},function(t,u,e){"use strict";var n=e(2),i=e(6),r=e(47),o=Array.prototype.map,a=Object.keys,s=JSON.stringify;t.exports=function(t,u){var e,D,c,l=Object(arguments[2]);return n(t)&&n(t.literals)&&n(t.substitutions),u=i(u),e=a(u).filter(r),D=e.join(", "),c=e.map(function(t){return u[t]}),[t.literals].concat(o.call(t.substitutions,function(t){var u;if(t){try{u=new Function(D,"return ("+t+")")}catch(u){throw new TypeError("Unable to compile expression:\n\targs: "+s(D)+"\n\tbody: "+s(t)+"\n\terror: "+u.stack)}try{return u.apply(null,c)}catch(u){if(l.partial)return"${"+t+"}";throw new TypeError("Unable to resolve expression:\n\targs: "+s(D)+"\n\tbody: "+s(t)+"\n\terror: "+u.stack)}}}))}},function(t,u,e){"use strict";var n,i,r,o,a,s,D,c,l,C,d,h,p,f,F,A,E,y,m,v,B,b,g,w,S,k,N,x=e(4),O=e(1),T=e(2),P=e(7),R=e(5),j=e(8),L=e(49),I=Object.prototype.hasOwnProperty,M=O.apply(null,x(";{=([,<>+-*/%&|^!~?:}")),_=O.apply(null,x(";{=([,<>+-*/%&|^!~?:})]."));n=function(t){if(h&&!(d>=t))for(;d!==t;){if(!h)return;I.call(L,h)?I.call(j,h)&&(f=d,++p):A=h,h=v[++d]}},i=function(t){null!=S&&y.push([k,S,t]),k={point:d+1,line:p,column:d+1-f},S=d},r=function(){var t;return k.raw=v.slice(S,d),m.push(k),y.length?(t=y.pop(),k=t[0],S=t[1],void(N=t[2])):(k=null,S=null,void(N=null))},o=function(){var t=N;return N=E,++E,n(d+1),i(t),a},s=function(){if("'"===h||'"'===h)return w=h,h=v[++d],D;if("("===h||"{"===h||"["===h)++E;else if(")"===h||"}"===h||"]"===h)N===--E&&r();else if("/"===h&&I.call(M,A))return h=v[++d],C;return h!==B||!b&&A&&!F&&!I.call(_,A)?(A=h,h=v[++d],a):g(d,A,E)},c=function(){for(;;){if(!h)return;if(I.call(j,h))return f=d+1,void++p;h=v[++d]}},l=function(){for(;;){if(!h)return;if("*"!==h)I.call(j,h)&&(f=d+1,++p),h=v[++d];else if(h=v[++d],"/"===h)return}},a=function(){var t;for(F=!1;;){if(!h)return;if(I.call(L,h))F=!0,I.call(j,h)&&(f=d+1,++p);else{if("/"!==h)break;if(t=v[d+1],"/"===t)h=v[d+=2],F=!0,c();else{if("*"!==t)break;h=v[d+=2],F=!0,l()}}h=v[++d]}return s},D=function(){for(;;){if(!h)return;if(h===w)return h=v[++d],A=w,a;"\\"===h&&I.call(j,v[++d])&&(f=d+1,++p),h=v[++d]}},C=function(){for(;;){if(!h)return;if("/"===h)return A="/",h=v[++d],a;"\\"===h&&++d,h=v[++d]}},t.exports=u=function(t){function u(u,e,n){return t.apply(this,arguments)}return u.toString=function(){return t.toString()},u}(function(t,e,n){var i;if(v=String(T(t)),B=String(T(e)),1!==B.length)throw new TypeError(B+" should be one character long string");for(g=P(n),b=I.call(_,B),d=0,h=v[d],p=1,f=0,F=!1,A=null,E=0,y=[],m=[],u.forceStop=!1,i=a;i;)i=i();return m}),Object.defineProperties(u,{$ws:R(a),$common:R(s),collectNest:R(o),move:R(n),index:R.gs(function(){return d}),line:R.gs(function(){return p}),nest:R.gs(function(){return E}),columnIndex:R.gs(function(){return f}),next:R(function(t){if(h)return n(d+(t||1)),a()}),resume:R(function(){return s})})},function(t,u){"use strict";t.exports=RegExp.prototype.test.bind(/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|null|this|true|void|with|await|break|catch|class|const|false|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D])(?:[\$0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF])*$/);
},function(t,u,e){"use strict";var n=e(4),i=e(1);t.exports=i.apply(null,n(" \f\t\v​  ​᠎ ​  ​  ​  ​  ​  ​​​  ​　"))},function(t,u,e){"use strict";var n=e(1),i=e(8),r=e(48);t.exports=n.apply(null,Object.keys(i).concat(Object.keys(r)))},function(t,u){"use strict";function e(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,u){for(var e=0;e<u.length;e++){var n=u[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(u,e,n){return e&&t(u.prototype,e),n&&t(u,n),u}}(),i=function(){function t(){e(this,t),this.dict={}}return n(t,[{key:"addChild",value:function(t,u){this.hasParent(t)||(this.dict[t]=[]),this.dict[t].push(u)}},{key:"getChildren",value:function(t){if(!this.hasParent(t))return[];var u=this.dict[t];return delete this.dict[t],u}},{key:"hasParent",value:function(t){return this.dict.hasOwnProperty(t)}}]),t}();t.exports=i},function(t,u,e){"use strict";var n=e(12);t.exports.gatherComponentsData=function(t,u){var e=t.components,n={};for(var i in u){var r=u[i];if("string"==typeof r){if(e.hasOwnProperty(r)){var o=r,a=e[o];n[o]=AFRAME.utils.clone(a.data)}}else{var s=NAF.utils.childSchemaToKey(r),D=r.selector?t.querySelector(r.selector):t;if(D){var c=D.components[r.component];if(c){var l=r.property?c.data[r.property]:c.data;n[s]=AFRAME.utils.clone(l)}}}}return n},t.exports.findDirtyComponents=function(t,u,e){var i=t.components,r=[];for(var o in u){var a,s,D=u[o],c="string"==typeof D;if(c){var l=i.hasOwnProperty(D);if(!l)continue;a=D,s=i[D].data}else{var C=D.selector,d=D.component,h=D.property,p=C?t.querySelector(C):t,l=p&&p.components.hasOwnProperty(d);if(!l)continue;a=NAF.utils.childSchemaToKey(D),s=p.components[d].data,h&&(s=s[h])}var f=e.hasOwnProperty(a);if(f){var F=e[a];n(F,s)||r.push(D)}else r.push(D)}return r}},function(t,u){"use strict";t.exports.compressSyncData=function(t,u){var e=[];e.push(1),e.push(t.networkId),e.push(t.owner),e.push(t.parent),e.push(t.template);var n=this.compressComponents(t.components,u);return e.push(n),e},t.exports.compressComponents=function(t,u){for(var e={},n=0;n<u.length;n++){var i;i="string"==typeof u[n]?u[n]:NAF.utils.childSchemaToKey(u[n]),t.hasOwnProperty(i)&&(e[n]=t[i])}return e},t.exports.decompressSyncData=function(t,u){var e={};e[0]=0,e.networkId=t[1],e.owner=t[2],e.parent=t[3],e.template=t[4];var n=t[5],u=this.decompressComponents(n,u);return e.components=u,e},t.exports.decompressComponents=function(t,u){var e={};for(var n in t){var i,r=u[n];i="string"==typeof r?r:NAF.utils.childSchemaToKey(r),e[i]=t[n]}return e}},function(t,u){"use strict";function e(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,u){for(var e=0;e<u.length;e++){var n=u[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(u,e,n){return e&&t(u.prototype,e),n&&t(u,n),u}}(),i=function(){function t(){e(this,t),this.debug=!1}return n(t,[{key:"setDebug",value:function(t){this.debug=t}},{key:"write",value:function(){this.debug&&console.log.apply(this,arguments)}},{key:"error",value:function(){console.error.apply(this,arguments)}}]),t}();t.exports=i},function(t,u){"use strict";t.exports.getPhysicsData=function(t){var u=t.body;if(u){var e=NAF.physics.getConstraints(t),n={type:u.type,hasConstraint:e.length>0,position:u.position,quaternion:u.quaternion,velocity:u.velocity,angularVelocity:u.angularVelocity,timestamp:NAF.utils.now()};return n}return null},t.exports.getConstraints=function(t){if(!t.sceneEl.systems.physics||!t.body)return[];var u=t.sceneEl.systems.physics.world.constraints,e=[];if(u&&u.length>0)for(var n=0;n<u.length;n++)u[n].bodyA.id!=t.body.id&&u[n].bodyB.id!=t.body.id||e.push(u[n]);return e},t.exports.updatePhysics=function(t,u){var e=NAF.physics.getEntityBody(t);e&&""!=u&&(e.position.copy(u.position),e.quaternion.copy(u.quaternion),e.velocity.copy(u.velocity),e.angularVelocity.copy(u.angularVelocity))},t.exports.isStrongerThan=function(t,u){var e=t.body;return!(!e||!u)&&NAF.physics.calculatePhysicsStrength(e)>NAF.physics.calculatePhysicsStrength(u)},t.exports.calculatePhysicsStrength=function(t){var u=Math.abs(t.velocity.x)+Math.abs(t.velocity.y)+Math.abs(t.velocity.z),e=Math.abs(t.angularVelocity.x)+Math.abs(t.angularVelocity.y)+Math.abs(t.angularVelocity.z);return 2*u+e},t.exports.attachPhysicsLerp=function(t,u){AFRAME.utils.entity.setComponentProperty(t,"physics-lerp",{targetPosition:u.position,targetQuaternion:u.quaternion,targetVelocity:u.velocity,targetAngularVelocity:u.angularVelocity,time:1e3/NAF.options.updateRate})},t.exports.detachPhysicsLerp=function(t){t.hasAttribute("physics-lerp")&&t.removeAttribute("physics-lerp")},t.exports.sleep=function(t){var u=NAF.physics.getEntityBody(t);u&&u.sleep()},t.exports.wakeUp=function(t){var u=NAF.physics.getEntityBody(t);u&&u.sleepState==CANNON.Body.SLEEPING&&u.wakeUp()},t.exports.getEntityBody=function(t){if(t.body)return t.body;var u=t.querySelector("[dynamic-body], [static-body]");return u&&u.body?u.body:null},t.exports.collisionEvent="collide",t.exports.getDataFromCollision=function(t){return{body:t.detail.body,el:t.detail.body.el}}},function(t,u){"use strict";function e(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,u){for(var e=0;e<u.length;e++){var n=u[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(u,e,n){return e&&t(u.prototype,e),n&&t(u,n),u}}(),i={Update:"u",Remove:"r"},r=function(){function t(u){e(this,t),this.entities=u,this.setupDefaultDataSubscriptions(),this.connectedClients={},this.activeDataChannels={}}return n(t,[{key:"setNetworkAdapter",value:function(t){this.adapter=t}},{key:"setupDefaultDataSubscriptions",value:function(){this.dataChannelSubs={},this.dataChannelSubs[i.Update]=this.entities.updateEntity.bind(this.entities),this.dataChannelSubs[i.Remove]=this.entities.removeRemoteEntity.bind(this.entities)}},{key:"connect",value:function(t,u,e){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];NAF.app=u,NAF.room=e,this.adapter.setServerUrl(t),this.adapter.setApp(u),this.adapter.setRoom(e);var i={audio:n,video:!1,datachannel:!0};this.adapter.setWebRtcOptions(i),this.adapter.setServerConnectListeners(this.connectSuccess.bind(this),this.connectFailure.bind(this)),this.adapter.setDataChannelListeners(this.dataChannelOpen.bind(this),this.dataChannelClosed.bind(this),this.receivedData.bind(this)),this.adapter.setRoomOccupantListener(this.occupantsReceived.bind(this)),this.adapter.connect()}},{key:"onConnect",value:function(t){this.isConnected()?t():document.body.addEventListener("connected",t,!1)}},{key:"connectSuccess",value:function(t){NAF.log.write("Networked-Aframe Client ID:",t),NAF.clientId=t;var u=new CustomEvent("connected",{detail:{clientId:t}});document.body.dispatchEvent(u)}},{key:"connectFailure",value:function(t,u){NAF.log.error(t,"failure to connect")}},{key:"occupantsReceived",value:function(t){this.checkForDisconnectingClients(this.connectedClients,t),this.connectedClients=t,this.checkForConnectingClients(t)}},{key:"checkForDisconnectingClients",value:function(t,u){for(var e in t){var n=u.hasOwnProperty(e);n||(NAF.log.write("Closing stream to ",e),this.adapter.closeStreamConnection(e))}}},{key:"checkForConnectingClients",value:function(t){for(var u in t){var e=this.isNewClient(u)&&this.adapter.shouldStartConnectionTo(t[u]);e&&(NAF.log.write("Opening datachannel to ",u),this.adapter.startStreamConnection(u))}}},{key:"getConnectedClients",value:function(){return this.connectedClients}},{key:"isConnected",value:function(){return!!NAF.clientId}},{key:"isMineAndConnected",value:function(t){return this.isConnected()&&NAF.clientId===t}},{key:"isNewClient",value:function(t){return!this.isConnectedTo(t)}},{key:"isConnectedTo",value:function(t){return this.adapter.getConnectStatus(t)===NAF.adapters.IS_CONNECTED}},{key:"dataChannelOpen",value:function(t){NAF.log.write("Opened data channel from "+t),this.activeDataChannels[t]=!0,this.entities.completeSync(t);var u=new CustomEvent("clientConnected",{detail:{clientId:t}});document.body.dispatchEvent(u)}},{key:"dataChannelClosed",value:function(t){NAF.log.write("Closed data channel from "+t),this.activeDataChannels[t]=!1,this.entities.removeEntitiesOfClient(t);var u=new CustomEvent("clientDisconnected",{detail:{clientId:t}});document.body.dispatchEvent(u)}},{key:"hasActiveDataChannel",value:function(t){return this.activeDataChannels.hasOwnProperty(t)&&this.activeDataChannels[t]}},{key:"broadcastData",value:function(t,u){this.adapter.broadcastData(t,u)}},{key:"broadcastDataGuaranteed",value:function(t,u){this.adapter.broadcastDataGuaranteed(t,u)}},{key:"sendData",value:function(t,u,e,n){this.hasActiveDataChannel(t)&&(n?this.adapter.sendDataGuaranteed(t,u,e):this.adapter.sendData(t,u,e))}},{key:"sendDataGuaranteed",value:function(t,u,e){this.sendData(t,u,e,!0)}},{key:"subscribeToDataChannel",value:function(t,u){return this.isReservedDataType(t)?void NAF.log.error("NetworkConnection@subscribeToDataChannel: "+t+" is a reserved dataType. Choose another"):void(this.dataChannelSubs[t]=u)}},{key:"unsubscribeToDataChannel",value:function(t){return this.isReservedDataType(t)?void NAF.log.error("NetworkConnection@unsubscribeToDataChannel: "+t+" is a reserved dataType. Choose another"):void delete this.dataChannelSubs[t]}},{key:"isReservedDataType",value:function(t){return t==i.Update||t==i.Remove}},{key:"receivedData",value:function(t,u,e){this.dataChannelSubs.hasOwnProperty(u)?this.dataChannelSubs[u](t,u,e):NAF.log.error("NetworkConnection@receivedData: "+u+" has not been subscribed to yet. Call subscribeToDataChannel()")}}]),t}();t.exports=r},function(t,u,e){"use strict";function n(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,u){for(var e=0;e<u.length;e++){var n=u[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(u,e,n){return e&&t(u.prototype,e),n&&t(u,n),u}}(),r=e(50),o=function(){function t(){n(this,t),this.entities={},this.childCache=new r,this.onRemoteEntityCreatedEvent=new Event("remoteEntityCreated")}return i(t,[{key:"registerEntity",value:function(t,u){this.entities[t]=u}},{key:"createRemoteEntity",value:function(t){NAF.log.write("Creating remote entity",t);var u=t.networkId,e=document.createElement("a-entity");return e.setAttribute("id","naf-"+u),this.initPosition(e,t.components),this.initRotation(e,t.components),this.addNetworkComponent(e,t),this.registerEntity(u,e),e}},{key:"initPosition",value:function(t,u){var e=u.hasOwnProperty("position");if(e){var n=u.position;t.setAttribute("position",n)}}},{key:"initRotation",value:function(t,u){var e=u.hasOwnProperty("rotation");if(e){var n=u.rotation;t.setAttribute("rotation",n)}}},{key:"addNetworkComponent",value:function(t,u){var e={template:u.template,owner:u.owner,networkId:u.networkId};t.setAttribute("networked",e),t.firstUpdateData=u}},{key:"updateEntity",value:function(t,u,e){var n=1==e[0],i=n?e[1]:e.networkId;this.hasEntity(i)?this.entities[i].emit("networkUpdate",{entityData:e},!1):!n&&this.isFullSync(e)&&this.receiveFirstUpdateFromEntity(e)}},{key:"isFullSync",value:function(t){var u=Object.keys(t.components).length,e=NAF.schemas.getComponents(t.template).length;return u===e}},{key:"receiveFirstUpdateFromEntity",value:function(t){var u=t.parent,e=t.networkId,n=u&&!this.hasEntity(u);if(n)this.childCache.addChild(u,t);else{var i=this.createRemoteEntity(t);this.createAndAppendChildren(e,i),this.addEntityToPage(i,u)}}},{key:"createAndAppendChildren",value:function(t,u){for(var e=this.childCache.getChildren(t),n=0;n<e.length;n++){var i=e[n],r=i.networkId;if(this.hasEntity(r))console.warn("Tried to instantiate entity multiple times",r,i,"Existing entity:",this.getEntity(r));else{var o=this.createRemoteEntity(i);this.createAndAppendChildren(r,o),u.appendChild(o)}}}},{key:"addEntityToPage",value:function(t,u){this.hasEntity(u)?this.addEntityToParent(t,u):this.addEntityToSceneRoot(t)}},{key:"addEntityToParent",value:function(t,u){var e=document.getElementById("naf-"+u);e.appendChild(t)}},{key:"addEntityToSceneRoot",value:function(t){var u=document.querySelector("a-scene");u.appendChild(t)}},{key:"completeSync",value:function(t){for(var u in this.entities)this.entities.hasOwnProperty(u)&&this.entities[u].emit("syncAll",{targetClientId:t,takeover:!1},!1)}},{key:"removeRemoteEntity",value:function(t,u,e){var n=e.networkId;return this.removeEntity(n)}},{key:"removeEntitiesOfClient",value:function(t){var u=[];for(var e in this.entities){var n=NAF.utils.getNetworkOwner(this.entities[e]);if(n==t){var i=this.removeEntity(e);u.push(i)}}return u}},{key:"removeEntity",value:function(t){if(this.hasEntity(t)){var u=this.entities[t];return delete this.entities[t],u.parentNode.removeChild(u),u}return null}},{key:"getEntity",value:function(t){return this.entities.hasOwnProperty(t)?this.entities[t]:null}},{key:"hasEntity",value:function(t){return this.entities.hasOwnProperty(t)}}]),t}();t.exports=o},function(t,u){"use strict";function e(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,u){for(var e=0;e<u.length;e++){var n=u[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(u,e,n){return e&&t(u.prototype,e),n&&t(u,n),u}}(),i=function(){function t(){e(this,t),this.dict={}}return n(t,[{key:"add",value:function(t){this.validate(t)?this.dict[t.template]=t:(NAF.log.error("Schema not valid: ",t),NAF.log.error("See https://github.com/haydenjameslee/networked-aframe#syncing-custom-components"))}},{key:"hasTemplate",value:function(t){return this.dict.hasOwnProperty(t)}},{key:"getComponents",value:function(t){var u=["position","rotation"];return this.hasTemplate(t)&&(u=this.dict[t].components),u}},{key:"validate",value:function(t){return t.hasOwnProperty("template")&&t.hasOwnProperty("components")}},{key:"remove",value:function(t){delete this.dict[t]}},{key:"clear",value:function(){this.dict={}}}]),t}();t.exports=i},function(t,u,e){"use strict";function n(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,u){for(var e=0;e<u.length;e++){var n=u[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(u,e,n){return e&&t(u.prototype,e),n&&t(u,n),u}}(),r=e(60),o=e(59),a=function(){function t(){n(this,t),this.adapters={wseasyrtc:r,easyrtc:o},this.IS_CONNECTED=t.IS_CONNECTED,this.CONNECTING=t.CONNECTING,this.NOT_CONNECTED=t.NOT_CONNECTED}return i(t,[{key:"register",value:function(t,u){this.adapters[t]=u}},{key:"make",value:function(t){var u=t.toLowerCase();if(this.adapters[u]){var e=this.adapters[u];return new e}throw new Error("Adapter: "+t+" not registered. Please use NAF.adapters.register() to register this adapter.")}}]),t}();a.IS_CONNECTED="IS_CONNECTED",a.CONNECTING="CONNECTING",a.NOT_CONNECTED="NOT_CONNECTED",t.exports=a},function(t,u){"use strict";function e(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,u){for(var e=0;e<u.length;e++){var n=u[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(u,e,n){return e&&t(u.prototype,e),n&&t(u,n),u}}(),i=function(){function t(u){e(this,t),this.app="default",this.room="default",this.easyrtc=u||window.easyrtc,this.audioStreams={},this.pendingAudioRequest={}}return n(t,[{key:"setServerUrl",value:function(t){this.easyrtc.setSocketUrl(t)}},{key:"setApp",value:function(t){this.app=t}},{key:"setRoom",value:function(t){this.room=t,this.easyrtc.joinRoom(t,null)}},{key:"setWebRtcOptions",value:function(t){this.easyrtc.enableDataChannels(t.datachannel),this.easyrtc.enableVideo(!1),this.easyrtc.enableAudio(t.audio),this.easyrtc.enableVideoReceive(!1),this.easyrtc.enableAudioReceive(t.audio)}},{key:"setServerConnectListeners",value:function(t,u){this.connectSuccess=t,this.connectFailure=u}},{key:"setRoomOccupantListener",value:function(t){this.easyrtc.setRoomOccupantListener(function(u,e,n){t(e)})}},{key:"setDataChannelListeners",value:function(t,u,e){this.easyrtc.setDataChannelOpenListener(t),this.easyrtc.setDataChannelCloseListener(u),this.easyrtc.setPeerListener(e)}},{key:"connect",value:function(){var t=this,u=function(u){t._storeAudioStream(t.easyrtc.myEasyrtcid,t.easyrtc.getLocalStream()),t._myRoomJoinTime=t._getRoomJoinTime(u),t.connectSuccess(u)};this.easyrtc.audioEnabled?this._connectWithAudio(u,this.connectFailure):this.easyrtc.connect(this.app,u,this.connectFailure)}},{key:"shouldStartConnectionTo",value:function(t){return this._myRoomJoinTime<=t.roomJoinTime}},{key:"startStreamConnection",value:function(t){this.easyrtc.call(t,function(t,u){"datachannel"===u&&NAF.log.write("Successfully started datachannel to ",t)},function(t,u){console.error(t,u)},function(t){})}},{key:"closeStreamConnection",value:function(t){}},{key:"sendData",value:function(t,u,e){this.easyrtc.sendData(t,u,e)}},{key:"sendDataGuaranteed",value:function(t,u,e){this.easyrtc.sendDataWS(t,u,e)}},{key:"broadcastData",value:function(t,u){var e=this.easyrtc.getRoomOccupantsAsMap(this.room);for(var n in e)e.hasOwnProperty(n)&&n!==this.easyrtc.myEasyrtcid&&this.easyrtc.sendData(n,t,u)}},{key:"broadcastDataGuaranteed",value:function(t,u){var e={targetRoom:this.room};this.easyrtc.sendDataWS(e,t,u)}},{key:"getConnectStatus",value:function(t){var u=this.easyrtc.getConnectStatus(t);return u==this.easyrtc.IS_CONNECTED?NAF.adapters.IS_CONNECTED:u==this.easyrtc.NOT_CONNECTED?NAF.adapters.NOT_CONNECTED:NAF.adapters.CONNECTING}},{key:"getMediaStream",value:function(t){console.log("getMediaStream",t);var u=this;return this.audioStreams[t]?(NAF.log.write("Already had audio for "+t),Promise.resolve(this.audioStreams[t])):(NAF.log.write("Waiting on audio for "+t),new Promise(function(e){u.pendingAudioRequest[t]=e}))}},{key:"_storeAudioStream",value:function(t,u){this.audioStreams[t]=u,this.pendingAudioRequest[t]&&(NAF.log.write("got pending audio for "+t),this.pendingAudioRequest[t](u),delete this.pendingAudioRequest[t](u))}},{key:"_connectWithAudio",value:function(t,u){var e=this;this.easyrtc.setStreamAcceptor(this._storeAudioStream.bind(this)),this.easyrtc.setOnStreamClosed(function(t){delete e.audioStreams[t]}),this.easyrtc.initMediaSource(function(){e.easyrtc.connect(e.app,t,u)},function(t,u){console.error(t,u)})}},{key:"_getRoomJoinTime",value:function(t){var u=NAF.room,e=easyrtc.getRoomOccupantsAsMap(u)[t].roomJoinTime;return e}}]),t}();t.exports=i},function(t,u){"use strict";function e(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,u){for(var e=0;e<u.length;e++){var n=u[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(u,e,n){return e&&t(u.prototype,e),n&&t(u,n),u}}(),i=function(){function t(u){e(this,t),this.easyrtc=u||window.easyrtc,this.app="default",this.room="default",this.connectedClients=[]}return n(t,[{key:"setServerUrl",value:function(t){this.easyrtc.setSocketUrl(t)}},{key:"setApp",value:function(t){this.app=t}},{key:"setRoom",value:function(t){this.room=t,this.easyrtc.joinRoom(t,null)}},{key:"setWebRtcOptions",value:function(t){}},{key:"setServerConnectListeners",value:function(t,u){this.connectSuccess=t,this.connectFailure=u}},{key:"setRoomOccupantListener",value:function(t){this.easyrtc.setRoomOccupantListener(function(u,e,n){t(e)})}},{key:"setDataChannelListeners",value:function(t,u,e){this.openListener=t,this.closedListener=u,this.easyrtc.setPeerListener(e)}},{key:"connect",value:function(){this.easyrtc.connect(this.app,this.connectSuccess,this.connectFailure)}},{key:"shouldStartConnectionTo",value:function(t){return!0}},{key:"startStreamConnection",value:function(t){this.connectedClients.push(t),this.openListener(t)}},{key:"closeStreamConnection",value:function(t){var u=this.connectedClients.indexOf(t);u>-1&&this.connectedClients.splice(u,1),this.closedListener(t)}},{key:"sendData",value:function(t,u,e){this.easyrtc.sendDataWS(t,u,e)}},{key:"sendDataGuaranteed",value:function(t,u,e){this.sendData(t,u,e)}},{key:"broadcastData",value:function(t,u){var e={targetRoom:this.room};this.easyrtc.sendDataWS(e,t,u)}},{key:"broadcastDataGuaranteed",value:function(t,u){this.broadcastData(t,u)}},{key:"getConnectStatus",value:function(t){var u=this.connectedClients.indexOf(t)!=-1;return u?NAF.adapters.IS_CONNECTED:NAF.adapters.NOT_CONNECTED}}]),t}();t.exports=i},function(t,u,e){"use strict";var n=e(3);AFRAME.registerComponent("networked-audio-source",{schema:{positional:{default:!0}},init:function(){this.listener=null,this.stream=null,this._setMediaStream=this._setMediaStream.bind(this);var t=NAF.utils.getNetworkedEntity(this.el),u=t&&t.components.networked.data.owner;u?NAF.connection.adapter.getMediaStream(u).then(this._setMediaStream).catch(function(t){return n.log.error("Error getting media stream for "+u,t)}):""===u||n.log.error("[networked-audio-source] must be added on an entity, or a child of an entity, with the [networked] component.")},_setMediaStream:function(t){this.sound||this.setupSound(),t!=this.stream&&(this.stream&&this.sound.disconnect(),t&&(this.audioEl=new Audio,this.audioEl.srcObject=t,this.sound.setNodeSource(this.sound.context.createMediaStreamSource(t))),this.stream=t)},remove:function(){this.sound&&(this.el.removeObject3D(this.attrName),this.stream&&this.sound.disconnect())},setupSound:function(){var t=this.el,u=t.sceneEl;this.sound&&t.removeObject3D(this.attrName),u.audioListener||(u.audioListener=new THREE.AudioListener,u.camera&&u.camera.add(u.audioListener),u.addEventListener("camera-set-active",function(t){t.detail.cameraEl.getObject3D("camera").add(u.audioListener)})),this.listener=u.audioListener,this.sound=this.data.positional?new THREE.PositionalAudio(this.listener):new THREE.Audio(this.listener),t.setObject3D(this.attrName,this.sound)}})},function(t,u,e){"use strict";e(3);AFRAME.registerComponent("networked-scene",{schema:{serverURL:{default:"/"},app:{default:"default"},room:{default:"default"},connectOnLoad:{default:!0},onConnect:{default:"onConnect"},adapter:{default:"wsEasyRtc"},audio:{default:!1},debug:{default:!1}},init:function(){var t=this.el;t.addEventListener("connect",this.connect.bind(this)),this.data.connectOnLoad&&t.emit("connect",null,!1)},connect:function(){NAF.log.setDebug(this.data.debug),NAF.log.write("Networked-Aframe Connecting..."),this.checkDeprecatedProperties(),this.setupNetworkAdapter(),this.hasOnConnectFunction()&&this.callOnConnect(),NAF.connection.connect(this.data.serverURL,this.data.app,this.data.room,this.data.audio)},checkDeprecatedProperties:function(){},setupNetworkAdapter:function(){var t=this.data.adapter,u=NAF.adapters.make(t);NAF.connection.setNetworkAdapter(u)},hasOnConnectFunction:function(){return""!=this.data.onConnect&&window.hasOwnProperty(this.data.onConnect)},callOnConnect:function(){NAF.connection.onConnect(window[this.data.onConnect])}})},function(t,u,e){"use strict";var n=(e(3),e(51)),i=e(52),r=AFRAME.utils.bind;AFRAME.registerComponent("networked",{schema:{template:{default:""},showLocalTemplate:{default:!0},networkId:{default:""},owner:{default:""}},init:function(){var t=this.data,u=this.wasCreatedByNetwork();this.onConnected=r(this.onConnected,this),this.onSyncAll=r(this.onSyncAll,this),this.syncDirty=r(this.syncDirty,this),this.networkUpdateHandler=r(this.networkUpdateHandler,this),this.cachedData={},this.initNetworkParent(),""===t.networkId&&(t.networkId=NAF.utils.createNetworkId()),""!=t.template&&this.initTemplate(),u?(this.firstUpdate(),this.attachLerp()):this.registerEntity(t.networkId),""===this.data.owner&&(this.setNetworkIdWhenConnected(),NAF.connection.isConnected()&&this.syncAll()),document.body.dispatchEvent(this.entityCreatedEvent())},wasCreatedByNetwork:function(){return!!this.el.firstUpdateData},initNetworkParent:function(){var t=this.el.parentElement;t.hasOwnProperty("components")&&t.components.hasOwnProperty("networked")?this.parent=t:this.parent=null},attachLerp:function(){NAF.options.useLerp&&this.el.setAttribute("lerp","")},registerEntity:function(t){NAF.entities.registerEntity(t,this.el)},initTemplate:function(){var t=this.data;!this.wasCreatedByNetwork()&&t.showLocalTemplate;this.attachAndShowTemplate(t.template,t.showLocalTemplate)},attachAndShowTemplate:function(t,u){var e=this.el;this.data;this.templateEl&&e.removeChild(this.templateEl);var n=document.createElement("a-entity");n.setAttribute("template","src:"+t),n.setAttribute("visible",u),e.appendChild(n),this.templateEl=n},firstUpdate:function(){var t=this.el.firstUpdateData;this.networkUpdate(t),this.waitForTemplateAndUpdateChildren()},waitForTemplateAndUpdateChildren:function(){var t=this,u=function(){var u=t.el.firstUpdateData;t.networkUpdate(u)};this.templateEl?this.templateEl.addEventListener("templaterendered",function(){setTimeout(u)}):setTimeout(u)},setNetworkIdWhenConnected:function(){NAF.clientId?this.onConnected():this.listenForConnected()},listenForConnected:function(){document.body.addEventListener("connected",this.onConnected.bind(this),!1)},onConnected:function(){this.data.owner=NAF.clientId},isMine:function(){return NAF.connection.isMineAndConnected(this.data.owner)},play:function(){this.bindEvents()},bindEvents:function(){var t=this.el;t.addEventListener("sync",this.syncDirty),t.addEventListener("syncAll",this.onSyncAll),t.addEventListener("networkUpdate",this.networkUpdateHandler)},pause:function(){this.unbindEvents()},unbindEvents:function(){var t=this.el;t.removeEventListener("sync",this.syncDirty),t.removeEventListener("syncAll",this.onSyncAll),t.removeEventListener("networkUpdate",this.networkUpdateHandler)},tick:function(){this.isMine()&&this.needsToSync()&&this.syncDirty()},onSyncAll:function(t){var u=t.detail,e=u.takeover,n=u.targetClientId;this.syncAll(e,n)},syncAll:function(t,u){if(this.canSync()){this.updateNextSyncTime();var e=this.getAllSyncedComponents(),i=n.gatherComponentsData(this.el,e),r=this.createSyncData(i,t);u?NAF.connection.sendDataGuaranteed(u,"u",r):NAF.connection.broadcastDataGuaranteed("u",r),this.updateCache(i)}},syncDirty:function(){if(this.canSync()){this.updateNextSyncTime();var t=this.getAllSyncedComponents(),u=n.findDirtyComponents(this.el,t,this.cachedData);if(0!=u.length){var e=n.gatherComponentsData(this.el,u),r=this.createSyncData(e);NAF.options.compressSyncPackets&&(r=i.compressSyncData(r,t)),NAF.connection.broadcastData("u",r),this.updateCache(e)}}},canSync:function(){return this.data.owner&&this.isMine()},needsToSync:function(){return NAF.utils.now()>=this.nextSyncTime},updateNextSyncTime:function(){this.nextSyncTime=NAF.utils.now()+1e3/NAF.options.updateRate},createSyncData:function(t,u){var e=this.data;u=!!u;var n={0:0,networkId:e.networkId,owner:e.owner,template:e.template,parent:this.getParentId(),components:t};return n},getParentId:function(){if(this.initNetworkParent(),!this.parent)return null;var t=this.parent.getAttribute("networked");return t.networkId},getAllSyncedComponents:function(){return NAF.schemas.getComponents(this.data.template)},updateCache:function(t){for(var u in t)this.cachedData[u]=t[u]},networkUpdateHandler:function(t){var u=t.detail.entityData;this.networkUpdate(u)},networkUpdate:function(t){1==t[0]&&(t=i.decompressSyncData(t,this.getAllSyncedComponents())),this.updateComponents(t.components)},updateComponents:function(t){var u=this.el;for(var e in t)if(this.isSyncableComponent(e)){var n=t[e];if(NAF.utils.isChildSchemaKey(e)){var i=NAF.utils.keyToChildSchema(e),r=i.selector?u.querySelector(i.selector):u;r&&(i.property?r.setAttribute(i.component,i.property,n):r.setAttribute(i.component,n))}else u.setAttribute(e,n)}},isSyncableComponent:function(t){if(NAF.utils.isChildSchemaKey(t)){var u=NAF.utils.keyToChildSchema(t);return this.hasThisChildSchema(u)}return this.getAllSyncedComponents().indexOf(t)!=-1},hasThisChildSchema:function(t){var u=this.getAllSyncedComponents();for(var e in u){var n=u[e];if(NAF.utils.childSchemaEqual(n,t))return!0}return!1},remove:function(){if(this.isMine()){var t={networkId:this.data.networkId};NAF.connection.broadcastDataGuaranteed("r",t)}document.body.dispatchEvent(this.entityRemovedEvent(this.data.networkId))},entityCreatedEvent:function(){return new CustomEvent("entityCreated",{detail:{el:this.el}})},entityRemovedEvent:function(t){return new CustomEvent("entityRemoved",{detail:{networkId:t}})}})},function(t,u){"use strict";var e={debug:!1,updateRate:15,compressSyncPackets:!1,useLerp:!0,collisionOwnership:!0};t.exports=e},function(t,u){"use strict";t.exports.whenEntityLoaded=function(t,u){t.hasLoaded&&u(),t.addEventListener("loaded",function(){u()})},t.exports.createHtmlNodeFromString=function(t){var u=document.createElement("div");u.innerHTML=t;var e=u.firstChild;return e},t.exports.getNetworkOwner=function(t){var u=t.components;return u.hasOwnProperty("networked-remote")?t.components["networked-remote"].data.owner:u.hasOwnProperty("networked")?t.components.networked.data.owner:null},t.exports.getNetworkId=function(t){var u=t.components;return u.hasOwnProperty("networked-remote")?t.components["networked-remote"].data.networkId:u.hasOwnProperty("networked")?t.components.networked.networkId:null},t.exports.getNetworkType=function(t){var u=t.components;return u.hasOwnProperty("networked-remote")?"networked-remote":u.hasOwnProperty("networked")?"networked":null},t.exports.now=function(){return Date.now()},t.exports.createNetworkId=function(){return Math.random().toString(36).substring(2,9)},t.exports.delimiter="---",t.exports.childSchemaToKey=function(u){var e=(u.selector||"")+t.exports.delimiter+(u.component||"")+t.exports.delimiter+(u.property||"");return e},t.exports.keyToChildSchema=function(u){var e=u.split(t.exports.delimiter,3);return{selector:e[0]||void 0,component:e[1],property:e[2]||void 0}},t.exports.isChildSchemaKey=function(u){return u.indexOf(t.exports.delimiter)!=-1},t.exports.childSchemaEqual=function(t,u){return t.selector==u.selector&&t.component==u.component&&t.property==u.property},t.exports.getNetworkedEntity=function(t){for(;t&&(!t.components||!t.components.networked);)t=t.parentNode;return t},t.exports.monkeyPatchEntityFromTemplateChild=function(t,u,e){u.addEventListener("templaterendered",function(){var n=u.firstChild;Array.prototype.slice.call(n.attributes||[]).forEach(function(u){t.setAttribute(u.nodeName,u.nodeValue)});for(var i=n.firstChild;i;i=n.firstChild)n.removeChild(i),t.appendChild(i);n.pause&&n.pause(),u.pause(),setTimeout(function(){try{u.removeChild(n)}catch(t){}try{t.removeChild(u)}catch(t){}e&&e()})})}}]);